# ๐บ๏ธ ะะตะพะบะพะดะธัะพะฒะฐะฝะธะต ะฐะดัะตัะฐ โ ะะฐััััั ะฝะฐ ะบะฐััะต

## โ ะงัะพ ะดะพะฑะฐะฒะปะตะฝะพ

ะขะตะฟะตัั ะบะปะธะตะฝั ะผะพะถะตั **ะฒะฟะธัะฐัั ะฐะดัะตั ัะตะบััะพะผ** ะธ ัะธััะตะผะฐ ะฐะฒัะพะผะฐัะธัะตัะบะธ ะฝะฐะนะดัั ะตะณะพ ะฝะฐ ะบะฐััะต ะธ ะฟะพัััะพะธั ะผะฐััััั!

## ๐ ะะฐะบ ััะพ ัะฐะฑะพัะฐะตั

### 1. ะะปะธะตะฝั ะฒะฒะพะดะธั ะฐะดัะตั
```
ะะพะปะต ะฒะฒะพะดะฐ: "Dลuga 23, Gdaลsk"
```

### 2. ะะฐะถะธะผะฐะตั ะบะฝะพะฟะบั "ะะฐะนัะธ ะฝะฐ ะบะฐััะต" (๐บ๏ธ)
```
Button: ๐บ๏ธ ะะฐะนัะธ ะฝะฐ ะบะฐััะต / Find on map
```

### 3. ะกะธััะตะผะฐ ะฒัะฟะพะปะฝัะตั ะณะตะพะบะพะดะธัะพะฒะฐะฝะธะต
**Google Geocoding API:**
```typescript
const response = await fetch(
  `https://maps.googleapis.com/maps/api/geocode/json?address=${ะฐะดัะตั}&key=${API_KEY}`
);
```

**ะะตะทัะปััะฐั:**
```json
{
  "results": [{
    "geometry": {
      "location": {
        "lat": 54.3520,
        "lng": 18.6466
      }
    }
  }]
}
```

### 4. ะฃััะฐะฝะฐะฒะปะธะฒะฐะตะผ ะบะพะพัะดะธะฝะฐัั ะฝะฐ ะบะฐััะต
```typescript
setMapLocation({ lat: 54.3520, lng: 18.6466 });
```

### 5. ะะฐััะฐ ะพะฑะฝะพะฒะปัะตััั ะฐะฒัะพะผะฐัะธัะตัะบะธ
- ะัะฐัะฝัะน ะผะฐัะบะตั ะฟะตัะตะผะตัะฐะตััั ะฝะฐ ะฝะพะฒัั ะฟะพะทะธัะธั
- ะกััะพะธััั ะฝะพะฒัะน ะผะฐััััั (ัะธะฝัั ะปะธะฝะธั)
- ะะฐัััะธััะฒะฐะตััั ัะฐัััะพัะฝะธะต ะธ ะฒัะตะผั
- ะะฑะฝะพะฒะปัะตััั ะฑะปะพะบ ั ะธะฝัะพัะผะฐัะธะตะน ะพ ะดะพััะฐะฒะบะต

## ๐ฆ ะะพะผะฟะพะฝะตะฝัั

### 1. ะคัะฝะบัะธั `handleFindAddressOnMap()`
**ะคะฐะนะป:** `components/checkout/checkout-form.tsx`

**ะงัะพ ะดะตะปะฐะตั:**
1. ะัะพะฒะตััะตั ััะพ ะฐะดัะตั ะฒะฒะตะดัะฝ
2. ะะพะฑะฐะฒะปัะตั ", Gdaลsk, Poland" ะดะปั ัะพัะฝะพััะธ
3. ะัะทัะฒะฐะตั Google Geocoding API
4. ะะพะปััะฐะตั ะบะพะพัะดะธะฝะฐัั
5. ะฃััะฐะฝะฐะฒะปะธะฒะฐะตั `mapLocation` state
6. ะะพะบะฐะทัะฒะฐะตั toast ั ัะตะทัะปััะฐัะพะผ

**ะะพะด:**
```typescript
const handleFindAddressOnMap = async () => {
  if (!formData.address.trim()) {
    toast.error("ะะฒะตะดะธัะต ะฐะดัะตั");
    return;
  }

  setIsLoadingLocation(true);

  try {
    const response = await fetch(
      `https://maps.googleapis.com/maps/api/geocode/json?address=${encodeURIComponent(
        formData.address + ", Gdaลsk, Poland"
      )}&key=${process.env.NEXT_PUBLIC_GOOGLE_MAPS_API_KEY}`
    );
    const data = await response.json();

    if (data.status === "OK" && data.results[0]) {
      const location = data.results[0].geometry.location;
      setMapLocation({ lat: location.lat, lng: location.lng });
      toast.success("ะะดัะตั ะฝะฐะนะดะตะฝ ะฝะฐ ะบะฐััะต");
    } else {
      throw new Error("Address not found");
    }
  } catch (error) {
    toast.error("ะะดัะตั ะฝะต ะฝะฐะนะดะตะฝ");
  } finally {
    setIsLoadingLocation(false);
  }
};
```

### 2. Props `externalLocation` ะฒ DeliveryMap
**ะคะฐะนะป:** `components/maps/delivery-map.tsx`

**ะงัะพ ะดะพะฑะฐะฒะปะตะฝะพ:**
```typescript
interface DeliveryMapProps {
  externalLocation?: { lat: number; lng: number } | null;
}
```

**useEffect ะดะปั ะพะฑะฝะพะฒะปะตะฝะธั:**
```typescript
useEffect(() => {
  if (externalLocation) {
    setCustomerLocation(externalLocation);
  }
}, [externalLocation]);
```

### 3. UI ะบะฝะพะฟะบะฐ "ะะฐะนัะธ ะฝะฐ ะบะฐััะต"
**ะคะฐะนะป:** `components/checkout/checkout-form.tsx`

**ะะดะต:** ะะพะด ะฟะพะปะตะผ ะฒะฒะพะดะฐ ะฐะดัะตัะฐ

**ะะฝะตัะฝะธะน ะฒะธะด:**
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ [ะะพะปะต ะฐะดัะตัะฐ]         ๐  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ๐บ๏ธ ะะฐะนัะธ ะฝะฐ ะบะฐััะต        โ <- ะะพะฒะฐั ะบะฝะพะฟะบะฐ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

**ะกะพััะพัะฝะธั:**
- โ ะะบัะธะฒะฝะฐ: ะบะพะณะดะฐ ะฐะดัะตั ะฒะฒะตะดัะฝ
- โณ ะะฐะณััะทะบะฐ: ัะฟะธะฝะฝะตั + "ะัั..."
- โ Disabled: ะตัะปะธ ะฐะดัะตั ะฟัััะพะน

## ๐ฏ User Flow

### ะะฐัะธะฐะฝั 1: ะะปะธะบ ะฝะฐ ะบะฐััั
```
1. ะะปะธะตะฝั ะบะปะธะบะฐะตั ะฝะฐ ะบะฐััั
2. ะะฐัะบะตั ัััะฐะฝะฐะฒะปะธะฒะฐะตััั
3. ะะฐััััั ัััะพะธััั
4. ะะฐะฝะฝัะต ัะฐัััะธััะฒะฐัััั
โ ะะพัะพะฒะพ!
```

### ะะฐัะธะฐะฝั 2: ะะฒะพะด ะฐะดัะตัะฐ
```
1. ะะปะธะตะฝั ะฒะฒะพะดะธั: "Dลuga 23, Gdaลsk"
2. ะะฐะถะธะผะฐะตั: ๐บ๏ธ ะะฐะนัะธ ะฝะฐ ะบะฐััะต
3. ะะตะพะบะพะดะธัะพะฒะฐะฝะธะต โ ะบะพะพัะดะธะฝะฐัั
4. ะะฐัะบะตั ัััะฐะฝะฐะฒะปะธะฒะฐะตััั
5. ะะฐััััั ัััะพะธััั
6. ะะฐะฝะฝัะต ัะฐัััะธััะฒะฐัััั
โ ะะพัะพะฒะพ!
```

### ะะฐัะธะฐะฝั 3: ะะตะพะปะพะบะฐัะธั
```
1. ะะปะธะตะฝั ะฝะฐะถะธะผะฐะตั: ๐ (ะบะฝะพะฟะบะฐ ะณะตะพะปะพะบะฐัะธะธ)
2. ะัะฐัะทะตั ะทะฐะฟัะฐัะธะฒะฐะตั ัะฐะทัะตัะตะฝะธะต
3. ะะพะปััะฐะตะผ ะบะพะพัะดะธะฝะฐัั
4. Reverse geocoding โ ะฐะดัะตั
5. ะะดัะตั ะทะฐะฟะพะปะฝัะตััั
6. ะะฐัะบะตั ัััะฐะฝะฐะฒะปะธะฒะฐะตััั
7. ะะฐััััั ัััะพะธััั
โ ะะพัะพะฒะพ!
```

## ๐ง APIs ะธัะฟะพะปัะทัะตะผัะต

### 1. Google Geocoding API โ
**ะะฐะทะฝะฐัะตะฝะธะต:** ะะดัะตั โ ะะพะพัะดะธะฝะฐัั

**Endpoint:**
```
https://maps.googleapis.com/maps/api/geocode/json
```

**ะะฐัะฐะผะตััั:**
- `address` - ะฐะดัะตั ัะตะบััะพะผ
- `key` - API ะบะปัั

**ะัะธะผะตั ะทะฐะฟัะพัะฐ:**
```
?address=Dลuga+23,+Gdaลsk,+Poland&key=YOUR_KEY
```

**ะะธะผะธัั:**
- 28,000 ะทะฐะฟัะพัะพะฒ/ะผะตััั (ะฑะตัะฟะปะฐัะฝะพ)
- $5 ะทะฐ 1000 ะดะพะฟ. ะทะฐะฟัะพัะพะฒ

### 2. Google Directions API โ
**ะะฐะทะฝะฐัะตะฝะธะต:** ะะพัััะพะตะฝะธะต ะผะฐัััััะฐ

**ะัะฟะพะปัะทัะตััั:** ะ ะบะพะผะฟะพะฝะตะฝัะต DeliveryMap

### 3. OpenStreetMap Nominatim โ
**ะะฐะทะฝะฐัะตะฝะธะต:** Reverse geocoding (ะบะพะพัะดะธะฝะฐัั โ ะฐะดัะตั)

**ะัะฟะพะปัะทัะตััั:** ะ ััะฝะบัะธะธ `handleUseLocation()`

## ๐ ะัะธะผะตัั

### ะัะธะผะตั 1: ะฃัะฟะตัะฝัะน ะฟะพะธัะบ
```
Input: "Dลuga 23, Gdaลsk"
โ
Geocoding API
โ
Result: { lat: 54.348743, lng: 18.653618 }
โ
ะะฐััะฐ ะพะฑะฝะพะฒะปัะตััั
โ
ะะฐััััั: 2.1 ะบะผ, 25โ35 min, 9 zล
โ "ะะดัะตั ะฝะฐะนะดะตะฝ ะฝะฐ ะบะฐััะต"
```

### ะัะธะผะตั 2: ะะตะฟะพะปะฝัะน ะฐะดัะตั
```
Input: "Dลuga"
โ
Geocoding API
โ
Result: { lat: 54.348, lng: 18.653 } (ะฟัะธะผะตัะฝะพ)
โ
โ๏ธ ะะพะถะตั ะฑััั ะฝะตัะพัะฝะพ
๐ก ะะปะธะตะฝั ะผะพะถะตั ััะพัะฝะธัั ะบะปะธะบะพะผ ะฝะฐ ะบะฐััะต
```

### ะัะธะผะตั 3: ะะดัะตั ะฝะต ะฝะฐะนะดะตะฝ
```
Input: "asdfghjkl"
โ
Geocoding API
โ
Result: ZERO_RESULTS
โ
โ "ะะดัะตั ะฝะต ะฝะฐะนะดะตะฝ"
๐ก ะัะพะฒะตัััะต ะฝะฐะฟะธัะฐะฝะธะต ะธะปะธ ะฒัะฑะตัะธัะต ะฝะฐ ะบะฐััะต
```

## โก ะะฟัะธะผะธะทะฐัะธั

### 1. ะััะธัะพะฒะฐะฝะธะต โ
```typescript
const geocodeCache = new Map();

if (geocodeCache.has(address)) {
  return geocodeCache.get(address);
}
// ...
geocodeCache.set(address, result);
```

### 2. Debounce (ะฑัะดััะตะต) โณ
```typescript
import { debounce } from 'lodash';

const debouncedGeocode = useMemo(
  () => debounce(handleFindAddressOnMap, 500),
  []
);
```

### 3. ะะฒัะพะดะพะฟะพะปะฝะตะฝะธะต (ัะปะตะดัััะธะน ัะฐะณ) โณ
```typescript
import { Autocomplete } from "@react-google-maps/api";

<Autocomplete onPlaceChanged={...}>
  <Input placeholder="ะะดัะตั" />
</Autocomplete>
```

## ๐จ UI States

### Loading State
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  โณ ะัั...                 โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### Success State
```
โ ะะดัะตั ะฝะฐะนะดะตะฝ ะฝะฐ ะบะฐััะต
[ะะฐััะฐ ั ะผะฐัััััะพะผ]
```

### Error State
```
โ ะะดัะตั ะฝะต ะฝะฐะนะดะตะฝ
๐ก ะัะพะฒะตัััะต ะฝะฐะฟะธัะฐะฝะธะต ะธะปะธ ะฒัะฑะตัะธัะต ะฝะฐ ะบะฐััะต
```

## ๐ ะงัะพ ะดะฐะปััะต (Next Level)

### 1. Google Places Autocomplete โณ
**ะะฐัะตะผ:** ะะฒัะพะดะพะฟะพะปะฝะตะฝะธะต ะฟัะธ ะฒะฒะพะดะต

**ะะฐะบ ะฑัะดะตั:**
```
Input: "Dลug..."
โ
Dropdown:
  - Dลuga 1, Gdaลsk
  - Dลuga 10, Gdaลsk
  - Dลuga 23, Gdaลsk
  - Dลuga 45, Gdaลsk
```

**ะฃััะฐะฝะพะฒะบะฐ:**
```bash
# ะฃะถะต ัััะฐะฝะพะฒะปะตะฝะพ
```

**ะะพะผะฟะพะฝะตะฝั:**
```typescript
<Autocomplete
  onPlaceChanged={() => {
    const place = autocomplete.getPlace();
    setFormData({ address: place.formatted_address });
    setMapLocation({
      lat: place.geometry.location.lat(),
      lng: place.geometry.location.lng()
    });
  }}
>
  <Input placeholder="ะะฐัะฝะธัะต ะฒะฒะพะดะธัั ะฐะดัะตั..." />
</Autocomplete>
```

### 2. ะััะพัะธั ะฐะดัะตัะพะฒ โณ
**ะะฐัะตะผ:** ะัััััะน ะฒัะฑะพั ะธะท ัะฐะฝะตะต ะธัะฟะพะปัะทะพะฒะฐะฝะฝัั

**LocalStorage:**
```typescript
const savedAddresses = JSON.parse(
  localStorage.getItem('delivery_addresses') || '[]'
);
```

### 3. ะะฐะปะธะดะฐัะธั ะทะพะฝั ะดะพััะฐะฒะบะธ โณ
**ะะฐัะตะผ:** ะะปะพะบะธัะพะฒะฐัั ะฐะดัะตัะฐ ะฒะฝะต Gdaลsk

**ะัะพะฒะตัะบะฐ:**
```typescript
if (!address.includes('Gdaลsk')) {
  toast.error("ะั ะดะพััะฐะฒะปัะตะผ ัะพะปัะบะพ ะฒ ะะดะฐะฝััะบ");
  return;
}
```

## โ ะขะตะบััะธะน ััะฐััั

**ะะฐะฑะพัะฐะตั:**
- โ ะะฒะพะด ะฐะดัะตัะฐ ัะตะบััะพะผ
- โ ะะฝะพะฟะบะฐ "ะะฐะนัะธ ะฝะฐ ะบะฐััะต"
- โ ะะตะพะบะพะดะธัะพะฒะฐะฝะธะต ัะตัะตะท Google API
- โ ะฃััะฐะฝะพะฒะบะฐ ะผะฐัะบะตัะฐ ะฝะฐ ะบะฐััะต
- โ ะะพัััะพะตะฝะธะต ะผะฐัััััะฐ
- โ ะะฐัััั ัะฐัััะพัะฝะธั ะธ ะฒัะตะผะตะฝะธ
- โ Toast-ัะฒะตะดะพะผะปะตะฝะธั
- โ Loading states
- โ Error handling
- โ ะัะปััะธัะทััะฝะพััั (pl/en/uk/ru)

**TODO:**
- โณ Autocomplete
- โณ ะััะพัะธั ะฐะดัะตัะพะฒ
- โณ ะะฐะปะธะดะฐัะธั ะทะพะฝั

---

**๐ฏ ะัะพะณ:** ะขะตะฟะตัั ะบะปะธะตะฝั ะผะพะถะตั **ะฒะฟะธัะฐัั ะฐะดัะตั โ ะฝะฐะนัะธ ะฝะฐ ะบะฐััะต โ ัะฒะธะดะตัั ะผะฐััััั** ะฟะพะปะฝะพัััั ะฐะฒัะพะผะฐัะธัะตัะบะธ! ๐
