# üé¨ –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç –∫–∞–∫ –≤ Bolt

## üìã –ó–∞–¥–∞—á–∞
–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–ª–∞–≤–Ω—É—é –∞–Ω–∏–º–∞—Ü–∏—é –ø—Ä–æ—Ä–∏—Å–æ–≤–∫–∏ –º–∞—Ä—à—Ä—É—Ç–∞ –¥–æ—Å—Ç–∞–≤–∫–∏, –∫–∞–∫ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö Bolt, Glovo, Uber Eats.

## ‚ùå –ü–æ—á–µ–º—É –ù–ï DirectionsRenderer?
`DirectionsRenderer` –æ—Ç Google Maps **—Å—Ä–∞–∑—É —Ä–∏—Å—É–µ—Ç –≤–µ—Å—å –º–∞—Ä—à—Ä—É—Ç** —Ü–µ–ª–∏–∫–æ–º. –ù–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª—è –Ω–∞–¥ –∞–Ω–∏–º–∞—Ü–∏–µ–π, –Ω–µ–ª—å–∑—è –¥–æ–±–∞–≤–ª—è—Ç—å —Ç–æ—á–∫–∏ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ: Polyline + Animation

### üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
```
Directions API
   ‚Üì
overview_path (–º–∞—Å—Å–∏–≤ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç)
   ‚Üì
Animated Polyline (–ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ—á–µ–∫)
   ‚Üì
–ú–∞—Ä–∫–µ—Ä—ã –ø–æ–≤–µ—Ä—Ö –º–∞—Ä—à—Ä—É—Ç–∞
```

---

## üîß –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

### 1Ô∏è‚É£ –ò–º–ø–æ—Ä—Ç—ã
```tsx
import {
  GoogleMap,
  Marker,
  Polyline,  // ‚úÖ –í–º–µ—Å—Ç–æ DirectionsRenderer
  useJsApiLoader,
} from "@react-google-maps/api";
```

### 2Ô∏è‚É£ State –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏
```tsx
// –ü–æ–ª–Ω—ã–π –ø—É—Ç—å –º–∞—Ä—à—Ä—É—Ç–∞ (–ø–æ–ª—É—á–∞–µ–º –∏–∑ Directions API)
const [fullPath, setFullPath] = useState<{ lat: number; lng: number }[]>([]);

// –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—É—Ç—å (–ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –¥–æ–±–∞–≤–ª—è–µ–º —Ç–æ—á–∫–∏)
const [animatedPath, setAnimatedPath] = useState<{ lat: number; lng: number }[]>([]);
```

### 3Ô∏è‚É£ –ü–æ–ª—É—á–∞–µ–º –º–∞—Ä—à—Ä—É—Ç –∏ –∏–∑–≤–ª–µ–∫–∞–µ–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
```tsx
directionsService.route(
  {
    origin: RESTAURANT_LOCATION,
    destination: customerLocation,
    travelMode: google.maps.TravelMode.DRIVING,
  },
  (result, status) => {
    if (status === "OK" && result) {
      setDirections(result);

      // ‚ú® –ò–∑–≤–ª–µ–∫–∞–µ–º –º–∞—Å—Å–∏–≤ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏
      const route = result.routes[0];
      if (route && route.overview_path) {
        const path = route.overview_path.map((p) => ({
          lat: p.lat(),
          lng: p.lng(),
        }));
        setFullPath(path);
      }
    }
  }
);
```

**–ü–æ—á–µ–º—É `overview_path`?**
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤ —Ç–æ—á–µ–∫ (–ø–ª–∞–≤–Ω–∞—è –ª–∏–Ω–∏—è)
- ‚úÖ –ú–µ–Ω—å—à–µ —Ç–æ—á–µ–∫ = –±—ã—Å—Ç—Ä–∞—è –∞–Ω–∏–º–∞—Ü–∏—è
- ‚úÖ –ò–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏

–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:
- `legs[0].steps` - —Å–ª–∏—à–∫–æ–º –¥–µ—Ç–∞–ª—å–Ω–æ, –º–Ω–æ–≥–æ —Ç–æ—á–µ–∫
- `legs[0].via_waypoints` - —Ç–æ–ª—å–∫–æ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —Ç–æ—á–∫–∏

### 4Ô∏è‚É£ –ê–Ω–∏–º–∞—Ü–∏—è –ø—Ä–æ—Ä–∏—Å–æ–≤–∫–∏ –º–∞—Ä—à—Ä—É—Ç–∞
```tsx
useEffect(() => {
  if (!fullPath.length) {
    setAnimatedPath([]);
    return;
  }

  let i = 0;
  setAnimatedPath([]);

  const interval = setInterval(() => {
    setAnimatedPath((prev) => [...prev, fullPath[i]]);
    i++;

    if (i >= fullPath.length) {
      clearInterval(interval);
    }
  }, 25); // –°–∫–æ—Ä–æ—Å—Ç—å –∞–Ω–∏–º–∞—Ü–∏–∏

  return () => clearInterval(interval);
}, [fullPath]);
```

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏:**
- `20‚Äì30 ms` ‚Üí –∫–∞–∫ Bolt (–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ)
- `10 ms` ‚Üí ¬´–±—ã—Å—Ç—Ä—ã–π –∫—É—Ä—å–µ—Ä¬ª
- `40 ms` ‚Üí –ø–ª–∞–≤–Ω–∞—è cinematic –∞–Ω–∏–º–∞—Ü–∏—è

### 5Ô∏è‚É£ –†–∏—Å—É–µ–º –∞–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—É—é –ª–∏–Ω–∏—é
```tsx
{animatedPath.length > 0 && (
  <Polyline
    path={animatedPath}
    options={{
      strokeColor: "#22c55e",
      strokeOpacity: 1,
      strokeWeight: 5,
      icons: [
        {
          icon: {
            path: "M 0,-1 0,1",
            strokeOpacity: 1,
            scale: 3,
          },
          offset: "0",
          repeat: "12px",
        },
      ],
    }}
  />
)}
```

**–≠—Ñ—Ñ–µ–∫—Ç "–∂–∏–≤–æ–π –ª–∏–Ω–∏–∏" (dashed):**
- `icons` + `repeat` —Å–æ–∑–¥–∞—é—Ç –ø—É–Ω–∫—Ç–∏—Ä–Ω—É—é –∞–Ω–∏–º–∞—Ü–∏—é
- –í–∏–∑—É–∞–ª—å–Ω–æ –ø–æ—Ö–æ–∂–µ –Ω–∞ Bolt/Glovo
- –î–æ–±–∞–≤–ª—è–µ—Ç –¥–∏–Ω–∞–º–∏—á–Ω–æ—Å—Ç—å

---

## üé® –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è –º–∞—Ä—à—Ä—É—Ç–∞

### –¶–≤–µ—Ç–∞:
```tsx
strokeColor: "#22c55e"  // –ó–µ–ª–µ–Ω—ã–π (–∞–∫—Ç–∏–≤–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞)
strokeColor: "#3b82f6"  // –°–∏–Ω–∏–π (–ø–ª–∞–Ω–∏—Ä—É–µ–º—ã–π –º–∞—Ä—à—Ä—É—Ç)
strokeColor: "#ef4444"  // –ö—Ä–∞—Å–Ω—ã–π (–ø—Ä–æ–±–ª–µ–º—ã)
```

### –¢–æ–ª—â–∏–Ω–∞ –ª–∏–Ω–∏–∏:
```tsx
strokeWeight: 5  // –í–∏–¥–Ω–æ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö
strokeWeight: 3  // –¢–æ–Ω–∫–∞—è –ª–∏–Ω–∏—è
strokeWeight: 7  // –ñ–∏—Ä–Ω–∞—è –ª–∏–Ω–∏—è
```

### –ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å:
```tsx
strokeOpacity: 1    // –ü–æ–ª–Ω–æ—Å—Ç—å—é –≤–∏–¥–∏–º–∞—è
strokeOpacity: 0.6  // –ü–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω–∞—è
```

---

## üöÄ –†–µ–∑—É–ª—å—Ç–∞—Ç

### ‚úÖ –ß—Ç–æ –ø–æ–ª—É—á–∞–µ–º:
1. **–ü–ª–∞–≤–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è** - –º–∞—Ä—à—Ä—É—Ç —Ä–∏—Å—É–µ—Ç—Å—è –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ
2. **–ö–∞–∫ –≤ Bolt** - –≤–∏–∑—É–∞–ª—å–Ω–æ –Ω–µ–æ—Ç–ª–∏—á–∏–º–æ –æ—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª–∞
3. **–ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å** - –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–∫–æ—Ä–æ—Å—Ç—å, —Ü–≤–µ—Ç, —ç—Ñ—Ñ–µ–∫—Ç—ã
4. **–ù–µ –¥—ë—Ä–≥–∞–µ—Ç—Å—è –∫–∞—Ä—Ç–∞** - fitBounds —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
5. **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `overview_path` (–º–∞–ª–æ —Ç–æ—á–µ–∫)

### üé¨ –ü–æ—Ä—è–¥–æ–∫ –æ—Ç—Ä–∏—Å–æ–≤–∫–∏:
1. –ö–∞—Ä—Ç–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
2. –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –º–∞—Ä—à—Ä—É—Ç (Directions API)
3. –ò–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è `overview_path`
4. –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–Ω–∏–º–∞—Ü–∏—è –ø—Ä–æ—Ä–∏—Å–æ–≤–∫–∏
5. –õ–∏–Ω–∏—è –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ "—Ä–∞—Å—Ç—ë—Ç" –æ—Ç —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞ –∫ –∫–ª–∏–µ–Ω—Ç—É

---

## ‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏

### ‚ùå –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ DirectionsRenderer + Polyline –≤–º–µ—Å—Ç–µ
```tsx
// –ù–ï –î–ï–õ–ê–ô –¢–ê–ö:
<DirectionsRenderer directions={directions} />
<Polyline path={animatedPath} />
```
**–ü—Ä–æ–±–ª–µ–º–∞:** –ë—É–¥–µ—Ç 2 –º–∞—Ä—à—Ä—É—Ç–∞ –Ω–∞ –∫–∞—Ä—Ç–µ (–¥—É–±–ª—å)

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–π **—Ç–æ–ª—å–∫–æ Polyline**

---

### ‚ùå animatedPath –≤ useMemo
```tsx
// –ù–ï –î–ï–õ–ê–ô –¢–ê–ö:
const animatedPath = useMemo(() => {
  return fullPath.slice(0, index);
}, [fullPath, index]);
```
**–ü—Ä–æ–±–ª–µ–º–∞:** –ê–Ω–∏–º–∞—Ü–∏—è –Ω–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –ø–ª–∞–≤–Ω–æ

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–π `useState` + `setInterval`

---

### ‚ùå setInterval –±–µ–∑ cleanup
```tsx
// –ù–ï –î–ï–õ–ê–ô –¢–ê–ö:
useEffect(() => {
  setInterval(() => {
    // animation
  }, 25);
}, [fullPath]);
```
**–ü—Ä–æ–±–ª–µ–º–∞:** –£—Ç–µ—á–∫–∞ –ø–∞–º—è—Ç–∏, –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ —Ä–∞–±–æ—Ç–∞—é—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ

**–†–µ—à–µ–Ω–∏–µ:** –í—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–π `clearInterval`:
```tsx
return () => clearInterval(interval);
```

---

### ‚ùå –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ —Ç–æ—á–µ–∫ (–Ω–µ overview_path)
```tsx
// –ù–ï –î–ï–õ–ê–ô –¢–ê–ö:
const path = route.legs[0].steps.flatMap(step => step.path);
```
**–ü—Ä–æ–±–ª–µ–º–∞:** 
- –°–æ—Ç–Ω–∏ —Ç–æ—á–µ–∫
- –ú–µ–¥–ª–µ–Ω–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è
- –í—ã—Å–æ–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–π `overview_path`:
```tsx
const path = route.overview_path.map(p => ({
  lat: p.lat(),
  lng: p.lng(),
}));
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä—å:
1. ‚úÖ –ú–∞—Ä—à—Ä—É—Ç —Ä–∏—Å—É–µ—Ç—Å—è –ø–ª–∞–≤–Ω–æ –æ—Ç —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞ –∫ –∫–ª–∏–µ–Ω—Ç—É
2. ‚úÖ –ê–Ω–∏–º–∞—Ü–∏—è –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ –∫–æ–Ω—Ü–µ
3. ‚úÖ –ü—Ä–∏ –Ω–æ–≤–æ–º –∞–¥—Ä–µ—Å–µ –∞–Ω–∏–º–∞—Ü–∏—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
4. ‚úÖ –ö–∞—Ä—Ç–∞ –ø–æ–¥—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –ø–æ–¥ –≤–µ—Å—å –º–∞—Ä—à—Ä—É—Ç (fitBounds)
5. ‚úÖ –õ–∏–Ω–∏—è –∑–µ–ª—ë–Ω–∞—è —Å –ø—É–Ω–∫—Ç–∏—Ä–Ω—ã–º —ç—Ñ—Ñ–µ–∫—Ç–æ–º

### –ö–µ–π—Å—ã:
- **–ö–æ—Ä–æ—Ç–∫–∏–π –º–∞—Ä—à—Ä—É—Ç** (1-2 –∫–º) - –∞–Ω–∏–º–∞—Ü–∏—è ~1 —Å–µ–∫
- **–î–ª–∏–Ω–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç** (10+ –∫–º) - –∞–Ω–∏–º–∞—Ü–∏—è ~2-3 —Å–µ–∫
- **–°–º–µ–Ω–∞ –∞–¥—Ä–µ—Å–∞** - —Å—Ç–∞—Ä–∞—è –ª–∏–Ω–∏—è –∏—Å—á–µ–∑–∞–µ—Ç, –Ω–æ–≤–∞—è —Ä–∏—Å—É–µ—Ç—Å—è
- **–ö–ª–∏–∫ –ø–æ –∫–∞—Ä—Ç–µ** - –º–∞—Ä—à—Ä—É—Ç –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π

---

## üìÅ –§–∞–π–ª—ã

### –ò–∑–º–µ–Ω–µ–Ω–æ:
- `components/maps/delivery-map.tsx` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∞–Ω–∏–º–∞—Ü–∏—è Polyline

### –ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:
1. –ó–∞–º–µ–Ω—ë–Ω `DirectionsRenderer` –Ω–∞ `Polyline`
2. –î–æ–±–∞–≤–ª–µ–Ω–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ `fullPath` –∏ `animatedPath`
3. –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∞–Ω–∏–º–∞—Ü–∏—è —á–µ—Ä–µ–∑ `setInterval`
4. –î–æ–±–∞–≤–ª–µ–Ω dashed-—ç—Ñ—Ñ–µ–∫—Ç –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–π –ø—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

---

## üéØ –ò—Ç–æ–≥

–¢–µ–ø–µ—Ä—å –∫–∞—Ä—Ç–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç **—Ç–æ—á–Ω–æ –∫–∞–∫ –≤ Bolt**:
- ‚úÖ –ú–∞—Ä—à—Ä—É—Ç —Ä–∏—Å—É–µ—Ç—Å—è –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ
- ‚úÖ –ü–ª–∞–≤–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è
- ‚úÖ –ó–µ–ª—ë–Ω–∞—è –ø—É–Ω–∫—Ç–∏—Ä–Ω–∞—è –ª–∏–Ω–∏—è
- ‚úÖ –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ UX

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–æ—Å—Ç–∞–≤–∫–∏ –º–∏—Ä–æ–≤–æ–≥–æ —É—Ä–æ–≤–Ω—è! üöÄ
